(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64af5ac8"],{2339:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-header-wrapper",[a("a-card",{staticStyle:{"margin-top":"24px"},attrs:{bordered:!1}},[a("div",{staticClass:"operate"},[a("a-row",{staticClass:"filter",attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("a-col",{attrs:{span:12}},[t._v("列表")]),a("a-col",{attrs:{span:12}},[a("a-form",{staticClass:"form",attrs:{layout:"inline"}},[a("a-form-item",[a("a-input",{attrs:{placeholder:"search admin account","enter-button":""},model:{value:t.filter.account,callback:function(e){t.$set(t.filter,"account",e)},expression:"filter.account"}})],1),a("a-form-item",[a("a-button",{staticClass:"addAdmin",attrs:{type:"primary",loading:t.tableLoading,icon:"search"},on:{click:function(e){return t.getList()}}},[t._v(t._s(t.$t("search")))])],1)],1)],1)],1),a("a-button",{staticClass:"button",staticStyle:{width:"100%"},attrs:{type:"default"},on:{click:t.add}},[t._v(t._s(t.$t("add")))])],1),a("a-list",{attrs:{"item-layout":"horizontal","data-source":t.data},scopedSlots:t._u([{key:"renderItem",fn:function(e){return a("a-list-item",{},[a("a-row",{attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("a-col",{attrs:{span:6}},[a("a-list-item-meta",{attrs:{description:"描述: "+e.description}},[a("a",{attrs:{slot:"title",href:"javascript:;"},slot:"title"},[t._v(t._s(e.account)+" "),a("br"),t._v(" "),a("span",[t._v(t._s(e.email))])]),a("a-avatar",{attrs:{slot:"avatar",shape:"square",src:e.avatar,size:64},slot:"avatar"})],1)],1),a("a-col",{staticStyle:{},attrs:{span:6}},[a("div",{staticClass:"updated_at"},[t._v(" 更新时间 "),a("div",[t._v(t._s(e.updated_at))])])]),a("a-col",{attrs:{span:3}},["admin"!=e.account?a("div",{staticClass:"operation"},[a("a-button",{attrs:{type:"link"},on:{click:function(a){return t.edit(e)}}},[t._v(t._s(t.$t("edit")))]),a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},[t._v("更多"),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a-popconfirm",{attrs:{title:t.$t("confirm_delete"),"ok-text":"Yes","cancel-text":"No"},on:{confirm:function(a){return t.del(e.id)}}},[a("a",{attrs:{href:"#"}},[t._v(t._s(t.$t("delete")))])])],1)],1)],1)],1):t._e()])],1)],1)}}])})],1),a("a-drawer",{attrs:{title:t.formModue.title,width:"40%",visible:t.formModue.visible,footer:null},on:{close:function(e){t.formModue.visible=!1}}},[t.formModue.visible?a("module-form",{ref:"moduleForm",attrs:{formData:t.formModue.formData},on:{"update:formData":function(e){return t.$set(t.formModue,"formData",e)},"update:form-data":function(e){return t.$set(t.formModue,"formData",e)},success:t.success}}):t._e()],1)],1)},r=[],i=(a("e3b5"),a("b775"));function n(t){return Object(i["b"])({url:"/admin",method:"get",params:t})}function s(t){return Object(i["b"])({url:"/admin/store",method:"post",data:t})}function l(t,e){return Object(i["b"])({url:"/admin/save",method:"put",data:e})}function d(t){return Object(i["b"])({url:"/admin/delete",method:"delete",data:{id:t}})}var u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-form-model",{ref:"ruleForm",attrs:{rules:t.rules,model:t.modelForm,"label-col":{span:6},"wrapper-col":{span:16}}},[a("a-form-model-item",{attrs:{label:"Account",prop:"account"}},[a("a-input",{model:{value:t.modelForm.account,callback:function(e){t.$set(t.modelForm,"account",e)},expression:"modelForm.account"}})],1),a("a-form-model-item",{attrs:{label:"Avatar",prop:"avatar"}},[a("upload-image",{attrs:{imgUrl:t.modelForm.avatar},on:{"update:imgUrl":function(e){return t.$set(t.modelForm,"avatar",e)},"update:img-url":function(e){return t.$set(t.modelForm,"avatar",e)}}})],1),a("a-form-model-item",{attrs:{label:"Email",prop:"email"}},[a("a-input",{model:{value:t.modelForm.email,callback:function(e){t.$set(t.modelForm,"email",e)},expression:"modelForm.email"}})],1),a("a-form-model-item",{attrs:{label:"Phone",prop:"phone"}},[a("a-input",{attrs:{autocomplete:"phone"},model:{value:t.modelForm.phone,callback:function(e){t.$set(t.modelForm,"phone",e)},expression:"modelForm.phone"}})],1),a("a-form-model-item",{attrs:{label:"Password",prop:"password"}},[a("a-input",{attrs:{type:"text",autocomplete:"password"},model:{value:t.modelForm.password,callback:function(e){t.$set(t.modelForm,"password",e)},expression:"modelForm.password"}})],1),a("a-form-model-item",{attrs:{label:"Confirm Password",prop:"confirm_password"}},[a("a-input",{attrs:{type:"text"},model:{value:t.modelForm.confirm_password,callback:function(e){t.$set(t.modelForm,"confirm_password",e)},expression:"modelForm.confirm_password"}})],1),a("a-form-model-item",{attrs:{label:"Desccription",prop:"description"}},[a("a-input",{attrs:{type:"textarea"},model:{value:t.modelForm.description,callback:function(e){t.$set(t.modelForm,"description",e)},expression:"modelForm.description"}})],1),a("a-form-model-item",{attrs:{"wrapper-col":{span:16,offset:6}}},[a("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("确认")])],1)],1)},m=[];function c(t,e,a){return e?/^1[3456789]\d{9}$/.test(e)?a():a(new Error("手机号码不符合规范")):a(new Error("Please input the Phone"))}function p(t,e,a){return e&&(e.length>12||e.length<6)?a(new Error("密码限定6-12个字符串")):a()}var f=a("4588"),g={name:"ModuleForm",components:{UploadImage:f["a"]},props:{formData:{type:Object,default:function(){return{}}}},data:function(){var t=this,e=function(e,a,o){var r=t.modelForm.password;return r?0==r.length?o():r!==a?o(new Error("两次输入密码不一致")):o():o()};return{modelForm:{},rules:{account:[{required:!0,message:"请输入账号",trigger:"blur"}],avatar:[{required:!1,message:"Please upload avatar",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱"}],phone:[{required:!0,message:"请输入电话号码",trigger:"blur"},{validator:c,trigger:"blur"}],password:[{validator:p,trigger:"blur"}],confirm_password:[{validator:p,trigger:"blur"},{validator:e,trigger:"blur"}],description:[{required:!0,message:"请输入管理员的描述",trigger:"blur"}]},loading:!1}},methods:{onSubmit:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(!e)return!1;var a;t.loading=!0,a=t.modelForm.id?l(t.modelForm.id,t.modelForm):s(t.modelForm),a.then((function(e){t.$message.success(e.message),t.$emit("success")})).catch((function(){t.loading=!1}))}))}},created:function(){this.modelForm=this.formData}},h=g,v=a("5d22"),b=Object(v["a"])(h,u,m,!1,null,null,null),w=b.exports,_={name:"AdminList",components:{ModuleForm:w},data:function(){var t=this;return{data:[],status:"all",page:1,pagination:{onChange:function(e){t.page=e,t.getList()},showSizeChanger:!0,showQuickJumper:!0,pageSize:20,total:50},formModue:{title:"添加",visible:!1,formData:{}},filter:{account:""},confirmLoading:!1,tableLoading:!1}},created:function(){this.getList()},methods:{getList:function(){var t=this,e={page:this.page,pageSize:this.pageSize};e=Object.assign(e,this.filter),this.tableLoading=!0,n(e).then((function(e){var a=e.data;t.data=a.list,t.tableLoading=!1}))},add:function(){this.formModue.visible=!0,this.formModue.formData={}},del:function(t){var e=this;d(t).then((function(t){e.$message.success(t.message),e.getList()}))},success:function(){this.formModue.visible=!1,this.getList()},edit:function(t){t=JSON.parse(JSON.stringify(t)),this.$set(this,"formModue",{title:"编辑",visible:!0,formData:t})},show:function(){this.formModue={title:"编辑",visible:!0}}}},y=_,F=(a("d003"),Object(v["a"])(y,o,r,!1,null,"50cac852",null));e["default"]=F.exports},"3c91":function(t,e,a){},4588:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-upload",{staticClass:"image-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,action:t.url,data:t.data,"before-upload":t.beforeUpload},on:{change:t.handleChange}},[t.image?a("img",{attrs:{src:t.image,alt:"image"}}):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v("Upload")])],1)])],1)},r=[],i=a("b775");function n(t){return Object(i["b"])({url:"/qiniu",method:"get",data:t})}a("e3b5"),a("ea94"),a("a037"),a("5b12"),a("9b5f");var s=function(t){t=t||32;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",a=e.length,o="",r=0;r<t;r++)o+=e.charAt(Math.floor(Math.random()*a));return o},l={name:"UploadImage",props:{imgUrl:{type:String,default:function(){return""}}},data:function(){return{image:"https://cdn.surest.cn/uploads/t4zDf6BwrMWhA8sjzeEaWxhYCwsCpt4P",loading:!1,url:"",upload_dir:"",host:"",data:{token:"",key:""}}},created:function(){this.setUploadInfo(),this.image=this.imgUrl},methods:{setUploadInfo:function(){var t=this;n().then((function(e){var a=e.data,o=(a.bucket,a.token),r=a.url,i=a.host,n=a.upload_dir;t.url=r,t.data.token=o,t.host=i,t.upload_dir=n,t.data.key=t.upload_dir+s()}))},handleChange:function(t){if(this.data.key=this.upload_dir+s(),"uploading"!==t.file.status){if("done"===t.file.status){this.loading=!1;var e=this.host+t.file.response.key;this.uploadedImage(e)}}else this.loading=!0},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;e||this.$message.error("You can only upload JPG file!");var a=t.size/1024/1024<2;return a||this.$message.error("Image must smaller than 2MB!"),e&&a},uploadedImage:function(t){this.image=t,this.$emit("update:imgUrl",t)}}},d=l,u=(a("840e"),a("5d22")),m=Object(u["a"])(d,o,r,!1,null,"741e5579",null);e["a"]=m.exports},7945:function(t,e,a){},"840e":function(t,e,a){"use strict";a("3c91")},d003:function(t,e,a){"use strict";a("7945")}}]);