(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-389e7d83","chunk-61e79f8a","chunk-2d0b6c50","chunk-2d0afe49","chunk-2d221c26","chunk-2d0e4e22","chunk-2d21f30b"],{"0feb":function(e,t,r){"use strict";r.r(t),r.d(t,"getList",(function(){return a})),r.d(t,"add",(function(){return o})),r.d(t,"update",(function(){return i})),r.d(t,"del",(function(){return u})),r.d(t,"getPermisstionTree",(function(){return s}));var n=r("b775");function a(e){return Object(n["default"])({url:"/permission",method:"get",params:e})}function o(e){return Object(n["default"])({url:"/permission/store",method:"post",data:e})}function i(e){return Object(n["default"])({url:"/permission/save",method:"put",data:e})}function u(e){return Object(n["default"])({url:"/permission/delete",method:"delete",data:{id:e}})}function s(){return Object(n["default"])({url:"/permission/tree",method:"get"})}},"1da1":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));r("d3b7"),r("e6cf");function n(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(d){return void r(d)}u.done?t(s):Promise.resolve(s).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function u(e){n(i,a,o,u,s,"next",e)}function s(e){n(i,a,o,u,s,"throw",e)}u(void 0)}))}}},"1f27":function(e,t,r){"use strict";r.r(t),r.d(t,"getList",(function(){return a})),r.d(t,"add",(function(){return o})),r.d(t,"update",(function(){return i})),r.d(t,"del",(function(){return u})),r.d(t,"getMenuTree",(function(){return s}));var n=r("b775");function a(e){return Object(n["default"])({url:"/menu",method:"get",params:e})}function o(e){return Object(n["default"])({url:"/menu/store",method:"post",data:e})}function i(e){return Object(n["default"])({url:"/menu/save",method:"put",data:e})}function u(e){return Object(n["default"])({url:"/menu/delete",method:"delete",data:{id:e}})}function s(){return Object(n["default"])({url:"/menu/tree",method:"get"})}},4588:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-upload",{staticClass:"image-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,action:e.url,data:e.data,"before-upload":e.beforeUpload},on:{change:e.handleChange}},[e.image?r("img",{attrs:{src:e.image,alt:"image"}}):r("div",[r("a-icon",{attrs:{type:e.loading?"loading":"plus"}}),r("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1)])],1)},a=[],o=r("91b6"),i=r("d988"),u={name:"UploadImage",props:{imgUrl:{type:String,default:function(){return""}}},data:function(){return{image:"https://cdn.surest.cn/uploads/t4zDf6BwrMWhA8sjzeEaWxhYCwsCpt4P",loading:!1,url:"",upload_dir:"",host:"",data:{token:"",key:""}}},created:function(){this.setUploadInfo(),this.image=this.imgUrl},methods:{setUploadInfo:function(){var e=this;Object(o["getQiniuInfo"])().then((function(t){var r=t.data,n=(r.bucket,r.token),a=r.url,o=r.host,u=r.upload_dir;e.url=a,e.data.token=n,e.host=o,e.upload_dir=u,e.data.key=e.upload_dir+Object(i["randomString"])()}))},handleChange:function(e){if(this.data.key=this.upload_dir+Object(i["randomString"])(),"uploading"!==e.file.status){if("done"===e.file.status){this.loading=!1;var t=this.host+e.file.response.key;this.uploadedImage(t)}}else this.loading=!0},beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||this.$message.error("You can only upload JPG file!");var r=e.size/1024/1024<2;return r||this.$message.error("Image must smaller than 2MB!"),t&&r},uploadedImage:function(e){this.image=e,this.$emit("update:imgUrl",e)}}},s=u,d=(r("4ea9"),r("2877")),l=Object(d["a"])(s,n,a,!1,null,"1ccf5a9c",null);t["default"]=l.exports},"4ea9":function(e,t,r){"use strict";var n=r("9817"),a=r.n(n);a.a},"91b6":function(e,t,r){"use strict";r.r(t),r.d(t,"getQiniuInfo",(function(){return a}));var n=r("b775");function a(e){return Object(n["default"])({url:"/qiniu",method:"get",data:e})}},9817:function(e,t,r){},cc5e:function(e,t,r){"use strict";r.r(t),r.d(t,"getList",(function(){return a})),r.d(t,"add",(function(){return o})),r.d(t,"getRole",(function(){return i})),r.d(t,"update",(function(){return u})),r.d(t,"del",(function(){return s})),r.d(t,"getPermisstionTree",(function(){return d}));var n=r("b775");function a(e){return Object(n["default"])({url:"/role",method:"get",params:e})}function o(e){return Object(n["default"])({url:"/permission/store",method:"post",data:e})}function i(e){return Object(n["default"])({url:"/role/show",method:"get",params:e})}function u(e){return Object(n["default"])({url:"/role/save",method:"put",data:e})}function s(e){return Object(n["default"])({url:"/role/delete",method:"delete",data:{id:e}})}function d(){return Object(n["default"])({url:"/permission/tree",method:"get"})}},d988:function(e,t,r){"use strict";r.r(t),r.d(t,"filterEmpty",(function(){return n})),r.d(t,"getStrFullLength",(function(){return a})),r.d(t,"cutStrByFullLength",(function(){return o})),r.d(t,"randomString",(function(){return i}));r("4de4"),r("13d5"),r("ac1f"),r("1276"),r("498a");function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.filter((function(e){return e.tag||e.text&&""!==e.text.trim()}))}var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split("").reduce((function(e,t){var r=t.charCodeAt(0);return r>=0&&r<=128?e+1:e+2}),0)},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,r=0;return e.split("").reduce((function(e,n){var a=n.charCodeAt(0);return r+=a>=0&&a<=128?1:2,r<=t?e+n:e}),"")},i=function(e){e=e||32;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",r=t.length,n="",a=0;a<e;a++)n+=t.charAt(Math.floor(Math.random()*r));return n}},e547:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a-form-model",{ref:"ruleForm",attrs:{rules:e.rules,model:e.modelForm,"label-col":{span:4},"wrapper-col":{span:16}}},[e.modelForm.id?r("a-form-model-item",{attrs:{label:"Id",prop:"id"}},[r("a-input",{attrs:{disabled:""},model:{value:e.modelForm.id,callback:function(t){e.$set(e.modelForm,"id",t)},expression:"modelForm.id"}})],1):e._e(),r("a-form-model-item",{attrs:{label:"当前权限",prop:"permission_ids"}},[r("a-tree-select",{staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.permissions,"tree-checkable":"",replaceFields:e.replaceFields,placeholder:"Please select"},model:{value:e.modelForm.permission_ids,callback:function(t){e.$set(e.modelForm,"permission_ids",t)},expression:"modelForm.permission_ids"}})],1),r("a-form-model-item",{attrs:{label:"当前菜单",prop:"permission_ids"}},[r("a-tree-select",{staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.menus,"tree-checkable":"",replaceFields:e.replaceFields,placeholder:"Please select"},model:{value:e.modelForm.menu_ids,callback:function(t){e.$set(e.modelForm,"menu_ids",t)},expression:"modelForm.menu_ids"}})],1),r("a-form-model-item",{attrs:{label:"角色名称",prop:"name"}},[r("a-input",{attrs:{"allow-clear":""},model:{value:e.modelForm.name,callback:function(t){e.$set(e.modelForm,"name",t)},expression:"modelForm.name"}})],1),r("a-form-model-item",{attrs:{label:"角色描述",prop:"description"}},[r("a-textarea",{attrs:{"allow-clear":""},model:{value:e.modelForm.description,callback:function(t){e.$set(e.modelForm,"description",t)},expression:"modelForm.description"}})],1),r("a-form-model-item",{attrs:{label:"是否禁用",prop:"status"}},[r("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否","default-checked":"","allow-clear":""},model:{value:e.modelForm.status,callback:function(t){e.$set(e.modelForm,"status",t)},expression:"modelForm.status"}})],1),r("a-form-model-item",{attrs:{"wrapper-col":{offset:4}}},[r("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.onSubmit}},[e._v("确认")])],1)],1)},a=[],o=(r("a4d3"),r("e01a"),r("4de4"),r("b0c0"),r("96cf"),r("1da1")),i=r("ade3"),u=r("4588"),s=r("cc5e"),d=r("0feb"),l=r("1f27"),c={name:"ModuleForm",components:{UploadImage:u["default"]},props:{formData:{type:Object,default:function(){return{}}}},data:function(){return Object(i["a"])({modelForm:{},rules:{},loading:!1,availableMethods:["GET","POST","PUT","DELETE","ANY"],permissions:[],menus:[],replaceFields:{children:"children",title:"name",key:"id",value:"id"}},"rules",{name:[{required:!0,message:"请输入角色名称",tigger:"blur"}],description:[{required:!0,message:"请输入角色描述",tigger:"blur"},{type:"string",message:"角色描述最长不超过10个字符",min:1,max:10,tigger:"blur"}]})},methods:{onSubmit:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var r=JSON.parse(JSON.stringify(e.modelForm));Object.assign(r,{status:r.status?2:1}),Object(s["update"])(r).then((function(){e.$message.success("Success"),e.loading=!1,e.$emit("success")})).catch((function(){e.loading=!1}))}))},getRole:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(s["getRole"])({id:e}).then((function(e){var r=e.data,n=r.permission_ids,a=r.id,o=r.name,i=r.description,u=r.status,s=r.menu_ids,d={id:a,name:o,menu_ids:s,description:i,permission_ids:n||[],status:2==u};t.$set(t,"modelForm",d)}));case 2:case"end":return r.stop()}}),r)})))()},getPermissionTree:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["getPermisstionTree"])().then((function(t){var r=t.data;e.permissions=r.filter((function(e){return 1!=e.id}))}));case 2:case"end":return t.stop()}}),t)})))()},getMenuTree:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["getMenuTree"])().then((function(t){var r=t.data;e.menus=r}));case 2:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getPermissionTree();case 2:return t.next=4,e.getMenuTree();case 4:e.formData.id&&e.getRole(e.formData.id);case 5:case"end":return t.stop()}}),t)})))()}},m=c,f=r("2877"),p=Object(f["a"])(m,n,a,!1,null,null,null);t["default"]=p.exports}}]);