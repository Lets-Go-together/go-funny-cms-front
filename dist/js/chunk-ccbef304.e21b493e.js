(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ccbef304","chunk-11016b30","chunk-c24e12ec","chunk-2d0b6c50","chunk-2d0afe49","chunk-2d221c26","chunk-2d0e4e22","chunk-2d21f30b","chunk-2d0bdf79"],{"0feb":function(e,t,n){"use strict";n.r(t),n.d(t,"getList",(function(){return a})),n.d(t,"add",(function(){return o})),n.d(t,"update",(function(){return i})),n.d(t,"del",(function(){return s})),n.d(t,"getPermisstionTree",(function(){return u}));var r=n("b775");function a(e){return Object(r["default"])({url:"/permission",method:"get",params:e})}function o(e){return Object(r["default"])({url:"/permission/store",method:"post",data:e})}function i(e){return Object(r["default"])({url:"/permission/save",method:"put",data:e})}function s(e){return Object(r["default"])({url:"/permission/delete",method:"delete",data:{id:e}})}function u(){return Object(r["default"])({url:"/permission/tree",method:"get"})}},"1f27":function(e,t,n){"use strict";n.r(t),n.d(t,"getList",(function(){return a})),n.d(t,"add",(function(){return o})),n.d(t,"update",(function(){return i})),n.d(t,"del",(function(){return s})),n.d(t,"getMenuTree",(function(){return u}));var r=n("b775");function a(e){return Object(r["default"])({url:"/menu",method:"get",params:e})}function o(e){return Object(r["default"])({url:"/menu/store",method:"post",data:e})}function i(e){return Object(r["default"])({url:"/menu/save",method:"put",data:e})}function s(e){return Object(r["default"])({url:"/menu/delete",method:"delete",data:{id:e}})}function u(){return Object(r["default"])({url:"/menu/tree",method:"get"})}},"2df7":function(e,t,n){"use strict";n.r(t);var r=n("6abc");t["default"]={data:function(){return{pagination:{pageSize:10,page:1,total:0},pageParams:{pageSize:10,page:1}}},methods:{handleTableChange:function(e,t,n){var a=Object(r["a"])({},this.pagination);a.current=e.current,this.pagination=a,this.filters=Object.assign(this.filters,{pageSize:e.pageSize,page:e.current,sortField:n.field,sortOrder:n.order}),this.getList()}}}},"3c91":function(e,t,n){},4588:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-upload",{staticClass:"image-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,action:e.url,data:e.data,"before-upload":e.beforeUpload},on:{change:e.handleChange}},[e.image?n("img",{attrs:{src:e.image,alt:"image"}}):n("div",[n("a-icon",{attrs:{type:e.loading?"loading":"plus"}}),n("div",{staticClass:"ant-upload-text"},[e._v("Upload")])],1)])],1)},a=[],o=n("91b6"),i=n("d988"),s={name:"UploadImage",props:{imgUrl:{type:String,default:function(){return""}}},data:function(){return{image:"https://cdn.surest.cn/uploads/t4zDf6BwrMWhA8sjzeEaWxhYCwsCpt4P",loading:!1,url:"",upload_dir:"",host:"",data:{token:"",key:""}}},created:function(){this.setUploadInfo(),this.image=this.imgUrl},methods:{setUploadInfo:function(){var e=this;Object(o["getQiniuInfo"])().then((function(t){var n=t.data,r=(n.bucket,n.token),a=n.url,o=n.host,s=n.upload_dir;e.url=a,e.data.token=r,e.host=o,e.upload_dir=s,e.data.key=e.upload_dir+Object(i["randomString"])()}))},handleChange:function(e){if(this.data.key=this.upload_dir+Object(i["randomString"])(),"uploading"!==e.file.status){if("done"===e.file.status){this.loading=!1;var t=this.host+e.file.response.key;this.uploadedImage(t)}}else this.loading=!0},beforeUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||this.$message.error("You can only upload JPG file!");var n=e.size/1024/1024<2;return n||this.$message.error("Image must smaller than 2MB!"),t&&n},uploadedImage:function(e){this.image=e,this.$emit("update:imgUrl",e)}}},u=s,d=(n("840e"),n("5d22")),l=Object(d["a"])(u,r,a,!1,null,"741e5579",null);t["default"]=l.exports},"60b5":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("27ae");function r(e,t,n,r,a,o,i){try{var s=e[o](i),u=s.value}catch(d){return void n(d)}s.done?t(u):Promise.resolve(u).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,o){var i=e.apply(t,n);function s(e){r(i,a,o,s,u,"next",e)}function u(e){r(i,a,o,s,u,"throw",e)}s(void 0)}))}}},6999:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("page-header-wrapper",[n("a-card",[n("div",{staticClass:"filters"},[n("a-form",{attrs:{form:e.filters,layout:"inline"}},[n("a-form-item",{attrs:{label:""}},[n("a-input",{attrs:{placeholder:"Name | Url"},model:{value:e.filters.keyword,callback:function(t){e.$set(e.filters,"keyword",t)},expression:"filters.keyword"}})],1),n("a-form-item",{attrs:{label:""}},[n("a-button-group",[n("a-button",{attrs:{type:"primary",icon:"search",loading:e.tableLoading,"allow-clear":""},on:{click:function(t){return e.getList()}}},[e._v("查询")]),n("a-button",{attrs:{type:"primary",icon:"add",loading:e.tableLoading},on:{click:function(t){return e.add()}}},[e._v("添加")])],1)],1)],1)],1),n("a-divider",{attrs:{dashed:""}}),n("div",{staticClass:"tableList"},[n("a-table",{attrs:{loading:e.tableLoading,columns:e.columns,"data-source":e.data,pagination:e.pagination},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"icon",fn:function(e){return n("span",{},[n("a-icon",{attrs:{type:e}})],1)}},{key:"method",fn:function(t){return n("span",{},[n("a-tag",{attrs:{color:"#2db7f5"}},[e._v(e._s(t))])],1)}},{key:"status",fn:function(t){return n("span",{},[1==t?n("a-tag",{attrs:{color:"#87d068"}},[e._v("正常")]):n("a-tag",{attrs:{color:"#f50"}},[e._v("禁用")])],1)}},{key:"menus",fn:function(t){return n("span",{},e._l(t.menus,(function(t){return n("a-tag",{key:t,attrs:{color:"#87d068"}},[e._v(e._s(t))])})),1)}},{key:"action",fn:function(t){return n("span",{},[n("a-button",{attrs:{type:"link"},on:{click:function(n){return e.edit(t)}}},[e._v(e._s(e.$t("edit")))]),n("a-dropdown",[n("a",{staticClass:"ant-dropdown-link",on:{click:function(e){return e.preventDefault()}}},[e._v("更多"),n("a-icon",{attrs:{type:"down"}})],1),n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",[n("a-popconfirm",{attrs:{title:e.$t("confirm_delete"),"ok-text":"Yes","cancel-text":"No"},on:{confirm:function(n){return e.del(t.id)}}},[n("a",{attrs:{href:"#"}},[e._v(e._s(e.$t("delete")))])])],1)],1)],1)],1)}}])})],1)],1),n("a-drawer",{attrs:{title:e.formModue.title,width:"40%",visible:e.formModue.visible,"confirm-loading":e.formModue.loadding,footer:null},on:{close:function(t){e.formModue.visible=!1}}},[e.formModue.visible?n("module-form",{attrs:{formData:e.formModue.formData},on:{"update:formData":function(t){return e.$set(e.formModue,"formData",t)},"update:form-data":function(t){return e.$set(e.formModue,"formData",t)},success:e.success}}):e._e()],1)],1)},a=[],o=n("cc5e"),i=n("2df7"),s=n("e547"),u={mixins:[i["default"]],components:{ModuleForm:s["default"]},data:function(){return{filters:{name:"",url:""},columns:[{title:"Id",dataIndex:"id",key:"id"},{title:"角色名称",dataIndex:"name",key:"name"},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"},key:"status"},{title:"角色描述",dataIndex:"description",key:"description"},{title:"角色菜单",dataIndex:"menu_ids",key:"menu_ids"},{title:"菜单",scopedSlots:{customRender:"menus"},key:"menus"},{title:"创建时间",dataIndex:"created_at",key:"created_at"},{title:"操作",key:"action",scopedSlots:{customRender:"action"},fixed:"right"}],data:[],tableLoading:!1,formModue:{title:"添加",visible:!1,formData:{},loadding:!1}}},methods:{getList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t=Object.assign(t,this.pageParams,this.filters),this.tableLoading=!0,Object(o["getList"])(t).then((function(t){var n=t.data;e.data=n.list,e.tableLoading=!1,e.pagination.total=n.total})).catch((function(){e.tableLoading=!1}))},edit:function(e){e=JSON.parse(JSON.stringify(e)),this.$set(this,"formModue",{title:"编辑",visible:!0,formData:e})},del:function(e){var t=this;Object(o["del"])(parseInt(e)).then((function(e){t.$message.success(e.message),t.getList()}))},add:function(){this.$set(this,"formModue",{title:"添加",visible:!0,formData:{}})},success:function(){this.formModue.visible=!1,this.getList()}},mounted:function(){this.getList()}},d=u,l=n("5d22"),c=Object(l["a"])(d,r,a,!1,null,null,null);t["default"]=c.exports},"840e":function(e,t,n){"use strict";n("3c91")},"91b6":function(e,t,n){"use strict";n.r(t),n.d(t,"getQiniuInfo",(function(){return a}));var r=n("b775");function a(e){return Object(r["default"])({url:"/qiniu",method:"get",data:e})}},cc5e:function(e,t,n){"use strict";n.r(t),n.d(t,"getList",(function(){return a})),n.d(t,"add",(function(){return o})),n.d(t,"getRole",(function(){return i})),n.d(t,"update",(function(){return s})),n.d(t,"del",(function(){return u})),n.d(t,"getPermisstionTree",(function(){return d}));var r=n("b775");function a(e){return Object(r["default"])({url:"/role",method:"get",params:e})}function o(e){return Object(r["default"])({url:"/permission/store",method:"post",data:e})}function i(e){return Object(r["default"])({url:"/role/show",method:"get",params:e})}function s(e){return Object(r["default"])({url:"/role/save",method:"put",data:e})}function u(e){return Object(r["default"])({url:"/role/delete",method:"delete",data:{id:e}})}function d(){return Object(r["default"])({url:"/permission/tree",method:"get"})}},d988:function(e,t,n){"use strict";n.r(t),n.d(t,"filterEmpty",(function(){return r})),n.d(t,"getStrFullLength",(function(){return a})),n.d(t,"cutStrByFullLength",(function(){return o})),n.d(t,"randomString",(function(){return i}));n("e3b5"),n("ea94"),n("a037"),n("5b12"),n("9b5f");function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.filter((function(e){return e.tag||e.text&&""!==e.text.trim()}))}var a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split("").reduce((function(e,t){var n=t.charCodeAt(0);return n>=0&&n<=128?e+1:e+2}),0)},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=0;return e.split("").reduce((function(e,r){var a=r.charCodeAt(0);return n+=a>=0&&a<=128?1:2,n<=t?e+r:e}),"")},i=function(e){e=e||32;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=t.length,r="",a=0;a<e;a++)r+=t.charAt(Math.floor(Math.random()*n));return r}},e547:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-form-model",{ref:"ruleForm",attrs:{rules:e.rules,model:e.modelForm,"label-col":{span:4},"wrapper-col":{span:16}}},[e.modelForm.id?n("a-form-model-item",{attrs:{label:"Id",prop:"id"}},[n("a-input",{attrs:{disabled:""},model:{value:e.modelForm.id,callback:function(t){e.$set(e.modelForm,"id",t)},expression:"modelForm.id"}})],1):e._e(),n("a-form-model-item",{attrs:{label:"当前权限",prop:"permission_ids"}},[n("a-tree-select",{staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.permissions,"tree-checkable":"",replaceFields:e.replaceFields,placeholder:"Please select"},model:{value:e.modelForm.permission_ids,callback:function(t){e.$set(e.modelForm,"permission_ids",t)},expression:"modelForm.permission_ids"}})],1),n("a-form-model-item",{attrs:{label:"当前菜单",prop:"permission_ids"}},[n("a-tree-select",{staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":e.menus,"tree-checkable":"",replaceFields:e.replaceFields,placeholder:"Please select"},model:{value:e.modelForm.menu_ids,callback:function(t){e.$set(e.modelForm,"menu_ids",t)},expression:"modelForm.menu_ids"}})],1),n("a-form-model-item",{attrs:{label:"角色名称",prop:"name"}},[n("a-input",{attrs:{"allow-clear":""},model:{value:e.modelForm.name,callback:function(t){e.$set(e.modelForm,"name",t)},expression:"modelForm.name"}})],1),n("a-form-model-item",{attrs:{label:"角色描述",prop:"description"}},[n("a-textarea",{attrs:{"allow-clear":""},model:{value:e.modelForm.description,callback:function(t){e.$set(e.modelForm,"description",t)},expression:"modelForm.description"}})],1),n("a-form-model-item",{attrs:{label:"是否禁用",prop:"status"}},[n("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否","default-checked":"","allow-clear":""},model:{value:e.modelForm.status,callback:function(t){e.$set(e.modelForm,"status",t)},expression:"modelForm.status"}})],1),n("a-form-model-item",{attrs:{"wrapper-col":{offset:4}}},[n("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.onSubmit}},[e._v("确认")])],1)],1)},a=[],o=n("60b5"),i=n("7dd6"),s=(n("6a61"),n("1d43"),n("01e5"),n("e487"),n("e3b5"),n("4588")),u=n("cc5e"),d=n("0feb"),l=n("1f27"),c={name:"ModuleForm",components:{UploadImage:s["default"]},props:{formData:{type:Object,default:function(){return{}}}},data:function(){return Object(i["a"])({modelForm:{},rules:{},loading:!1,availableMethods:["GET","POST","PUT","DELETE","ANY"],permissions:[],menus:[],replaceFields:{children:"children",title:"name",key:"id",value:"id"}},"rules",{name:[{required:!0,message:"请输入角色名称",tigger:"blur"}],description:[{required:!0,message:"请输入角色描述",tigger:"blur"},{type:"string",message:"角色描述最长不超过10个字符",min:1,max:10,tigger:"blur"}]})},methods:{onSubmit:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var n=JSON.parse(JSON.stringify(e.modelForm));Object.assign(n,{status:n.status?2:1}),Object(u["update"])(n).then((function(){e.$message.success("Success"),e.loading=!1,e.$emit("success")})).catch((function(){e.loading=!1}))}))},getRole:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,Object(u["getRole"])({id:e}).then((function(e){var n=e.data,r=n.permission_ids,a=n.id,o=n.name,i=n.description,s=n.status,u=n.menu_ids,d={id:a,name:o,menu_ids:u,description:i,permission_ids:r||[],status:2==s};t.$set(t,"modelForm",d)}));case 2:case"end":return n.stop()}}),n)})))()},getPermissionTree:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(d["getPermisstionTree"])().then((function(t){var n=t.data;e.permissions=n.filter((function(e){return 1!=e.id}))}));case 2:case"end":return t.stop()}}),t)})))()},getMenuTree:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["getMenuTree"])().then((function(t){var n=t.data;e.menus=n}));case 2:case"end":return t.stop()}}),t)})))()}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getPermissionTree();case 2:return t.next=4,e.getMenuTree();case 4:e.formData.id&&e.getRole(e.formData.id);case 5:case"end":return t.stop()}}),t)})))()}},m=c,f=n("5d22"),p=Object(f["a"])(m,r,a,!1,null,null,null);t["default"]=p.exports}}]);