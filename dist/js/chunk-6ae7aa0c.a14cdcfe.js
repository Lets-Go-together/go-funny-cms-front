(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6ae7aa0c","chunk-73ab2fe9","chunk-c24e12ec","chunk-2d0afe49","chunk-2d0e4e22","chunk-2d21f30b","chunk-2d0bdf79"],{"0feb":function(t,e,a){"use strict";a.r(e),a.d(e,"getList",(function(){return r})),a.d(e,"add",(function(){return o})),a.d(e,"update",(function(){return i})),a.d(e,"del",(function(){return s})),a.d(e,"getPermisstionTree",(function(){return l}));var n=a("b775");function r(t){return Object(n["default"])({url:"/permission",method:"get",params:t})}function o(t){return Object(n["default"])({url:"/permission/store",method:"post",data:t})}function i(t){return Object(n["default"])({url:"/permission/save",method:"put",data:t})}function s(t){return Object(n["default"])({url:"/permission/delete",method:"delete",data:{id:t}})}function l(){return Object(n["default"])({url:"/permission/tree",method:"get"})}},"2df7":function(t,e,a){"use strict";a.r(e);var n=a("6abc");e["default"]={data:function(){return{pagination:{pageSize:10,page:1,total:0},pageParams:{pageSize:10,page:1}}},methods:{handleTableChange:function(t,e,a){var r=Object(n["a"])({},this.pagination);r.current=t.current,this.pagination=r,this.filters=Object.assign(this.filters,{pageSize:t.pageSize,page:t.current,sortField:a.field,sortOrder:a.order}),this.getList()}}}},"3c91":function(t,e,a){},"42c5":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-form-model",{ref:"ruleForm",attrs:{rules:t.rules,model:t.modelForm,"label-col":{span:4},"wrapper-col":{span:16}}},[t.modelForm.id?a("a-form-model-item",{attrs:{label:"Id",prop:"id"}},[a("a-input",{attrs:{disabled:""},model:{value:t.modelForm.id,callback:function(e){t.$set(t.modelForm,"id",e)},expression:"modelForm.id"}})],1):t._e(),a("a-form-model-item",{attrs:{label:"父节点",prop:"name"}},[a("a-tree-select",{staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":t.permissions,replaceFields:t.replaceFields,placeholder:"Please select"},model:{value:t.modelForm.p_id,callback:function(e){t.$set(t.modelForm,"p_id",e)},expression:"modelForm.p_id"}})],1),a("a-form-model-item",{attrs:{label:"权限名称",prop:"name"}},[a("a-input",{attrs:{"allow-clear":""},model:{value:t.modelForm.name,callback:function(e){t.$set(t.modelForm,"name",e)},expression:"modelForm.name"}})],1),a("a-form-model-item",{attrs:{label:"Url",prop:"url"}},[a("a-input",{attrs:{"allow-clear":""},model:{value:t.modelForm.url,callback:function(e){t.$set(t.modelForm,"url",e)},expression:"modelForm.url"}})],1),a("a-form-model-item",{attrs:{label:"请求方法",prop:"method"}},[a("a-radio-group",{attrs:{"button-style":"solid"},model:{value:t.modelForm.method,callback:function(e){t.$set(t.modelForm,"method",e)},expression:"modelForm.method"}},t._l(t.availableMethods,(function(e){return a("a-radio-button",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),a("a-form-model-item",{attrs:{label:"Icon",prop:"icon"}},[a("a-input",{attrs:{type:"url","allow-clear":""},model:{value:t.modelForm.icon,callback:function(e){t.$set(t.modelForm,"icon",e)},expression:"modelForm.icon"}})],1),a("a-form-model-item",{attrs:{label:"是否禁用",prop:"status"}},[a("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否","default-checked":"","allow-clear":""},model:{value:t.modelForm.status,callback:function(e){t.$set(t.modelForm,"status",e)},expression:"modelForm.status"}})],1),a("a-form-model-item",{attrs:{label:"是否隐藏",prop:"hidden"}},[a("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否","default-checked":"","allow-clear":""},model:{value:t.modelForm.hidden,callback:function(e){t.$set(t.modelForm,"hidden",e)},expression:"modelForm.hidden"}})],1),a("a-form-model-item",{attrs:{"wrapper-col":{offset:4}}},[a("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("确认")]),a("a-button",{staticStyle:{"margin-left":"10px"},on:{click:function(e){return t.$emit("close")}}},[t._v("取消")])],1)],1)},r=[],o=a("60b5"),i=(a("6a61"),a("4588")),s=a("0feb"),l={name:"ModuleForm",components:{UploadImage:i["default"]},props:{formData:{type:Object,default:function(){return{}}}},data:function(){return{modelForm:{},rules:{p_id:[{required:!0,message:"请选择父节点",tigger:"blur"}],name:[{required:!0,message:"请输入权限名称",tigger:"blur"}],url:[{required:!0,message:"请输入url",tigger:"blur"}],icon:[{required:!0,message:"请输入icon",tigger:"blur"}],method:[{required:!0,message:"请选择请求方法",tigger:"blur"}]},loading:!1,availableMethods:["GET","POST","PUT","DELETE","ANY"],permissions:[],replaceFields:{children:"children",title:"name",key:"id",value:"id"}}},methods:{onSubmit:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(e){if(t.modelForm.p_id==t.modelForm.id)return void t.$message.success("父节点设置错误: 不允许设置自己");t.loading=!0;var a=JSON.parse(JSON.stringify(t.modelForm));Object.assign(a,{status:a.status?2:1,hidden:a.hidden?2:1}),Object(s["update"])(a).then((function(e){t.$message.success("Success"),t.loading=!1,t.$emit("success")})).catch((function(){t.loading=!1}))}}))},getPermissionTree:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["getPermisstionTree"])().then((function(e){var a=e.data;t.permissions=a}));case 2:case"end":return e.stop()}}),e)})))()}},mounted:function(){this.modelForm=Object.assign(this.formData,{status:1==this.formData.status,hidden:1==this.formData.hidden}),this.getPermissionTree()}},d=l,u=a("5d22"),c=Object(u["a"])(d,n,r,!1,null,null,null);e["default"]=c.exports},4588:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-upload",{staticClass:"image-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,action:t.url,data:t.data,"before-upload":t.beforeUpload},on:{change:t.handleChange}},[t.image?a("img",{attrs:{src:t.image,alt:"image"}}):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v("Upload")])],1)])],1)},r=[],o=a("91b6"),i=a("d988"),s={name:"UploadImage",props:{imgUrl:{type:String,default:function(){return""}}},data:function(){return{image:"https://cdn.surest.cn/uploads/t4zDf6BwrMWhA8sjzeEaWxhYCwsCpt4P",loading:!1,url:"",upload_dir:"",host:"",data:{token:"",key:""}}},created:function(){this.setUploadInfo(),this.image=this.imgUrl},methods:{setUploadInfo:function(){var t=this;Object(o["getQiniuInfo"])().then((function(e){var a=e.data,n=(a.bucket,a.token),r=a.url,o=a.host,s=a.upload_dir;t.url=r,t.data.token=n,t.host=o,t.upload_dir=s,t.data.key=t.upload_dir+Object(i["randomString"])()}))},handleChange:function(t){if(this.data.key=this.upload_dir+Object(i["randomString"])(),"uploading"!==t.file.status){if("done"===t.file.status){this.loading=!1;var e=this.host+t.file.response.key;this.uploadedImage(e)}}else this.loading=!0},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;e||this.$message.error("You can only upload JPG file!");var a=t.size/1024/1024<2;return a||this.$message.error("Image must smaller than 2MB!"),e&&a},uploadedImage:function(t){this.image=t,this.$emit("update:imgUrl",t)}}},l=s,d=(a("840e"),a("5d22")),u=Object(d["a"])(l,n,r,!1,null,"741e5579",null);e["default"]=u.exports},"60b5":function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));a("27ae");function n(t,e,a,n,r,o,i){try{var s=t[o](i),l=s.value}catch(d){return void a(d)}s.done?e(l):Promise.resolve(l).then(n,r)}function r(t){return function(){var e=this,a=arguments;return new Promise((function(r,o){var i=t.apply(e,a);function s(t){n(i,r,o,s,l,"next",t)}function l(t){n(i,r,o,s,l,"throw",t)}s(void 0)}))}}},"840e":function(t,e,a){"use strict";a("3c91")},"91b6":function(t,e,a){"use strict";a.r(e),a.d(e,"getQiniuInfo",(function(){return r}));var n=a("b775");function r(t){return Object(n["default"])({url:"/qiniu",method:"get",data:t})}},"9c0d":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-header-wrapper",[a("a-card",[a("div",{staticClass:"filters"},[a("a-form",{attrs:{form:t.filters,layout:"inline"}},[a("a-form-item",{attrs:{label:""}},[a("a-input",{attrs:{placeholder:"Name | Url"},model:{value:t.filters.keyword,callback:function(e){t.$set(t.filters,"keyword",e)},expression:"filters.keyword"}})],1),a("a-form-item",{attrs:{label:""}},[a("a-button-group",[a("a-button",{attrs:{type:"primary",icon:"search",loading:t.tableLoading},on:{click:function(e){return t.getList()}}},[t._v("查询")]),a("a-button",{attrs:{type:"primary",icon:"add",loading:t.tableLoading},on:{click:function(e){return t.add()}}},[t._v("添加")])],1)],1)],1)],1),a("a-divider",{attrs:{dashed:""}}),a("div",{staticClass:"tableList"},[a("a-table",{attrs:{loading:t.tableLoading,columns:t.columns,"data-source":t.data,pagination:t.pagination},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"icon",fn:function(t){return a("span",{},[a("a-icon",{attrs:{type:t}})],1)}},{key:"method",fn:function(e){return a("span",{},[a("a-tag",{attrs:{color:"#2db7f5"}},[t._v(t._s(e))])],1)}},{key:"status",fn:function(e){return a("span",{},[1==e?a("a-tag",{attrs:{color:"#87d068"}},[t._v("正常")]):a("a-tag",{attrs:{color:"#f50"}},[t._v("禁用")])],1)}},{key:"hidden",fn:function(e){return a("span",{},[1==e?a("a-tag",{attrs:{color:"#87d068"}},[t._v("是")]):a("a-tag",{attrs:{color:"#f50"}},[t._v("否")])],1)}},{key:"action",fn:function(e){return a("span",{},[a("a-button",{attrs:{type:"link"},on:{click:function(a){return t.edit(e)}}},[t._v(t._s(t.$t("edit")))]),a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},[t._v("更多"),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a-popconfirm",{attrs:{title:t.$t("confirm_delete"),"ok-text":"Yes","cancel-text":"No"},on:{confirm:function(a){return t.del(e.id)}}},[a("a",{attrs:{href:"#"}},[t._v(t._s(t.$t("delete")))])])],1)],1)],1)],1)}}])})],1)],1),a("a-drawer",{attrs:{title:t.formModue.title,width:"800px",visible:t.formModue.visible,"confirm-loading":t.formModue.loadding},on:{close:function(e){t.formModue.visible=!1}}},[t.formModue.visible?a("module-form",{attrs:{formData:t.formModue.formData},on:{"update:formData":function(e){return t.$set(t.formModue,"formData",e)},"update:form-data":function(e){return t.$set(t.formModue,"formData",e)},success:t.success,close:function(e){t.formModue.visible=!1}}}):t._e()],1)],1)},r=[],o=a("0feb"),i=a("2df7"),s=a("42c5"),l={mixins:[i["default"]],components:{ModuleForm:s["default"]},data:function(){return{filters:{keyword:""},columns:[{title:"Id",dataIndex:"id",key:"id"},{title:"权限名称",dataIndex:"name",key:"name"},{title:"icon",scopedSlots:{customRender:"icon"},dataIndex:"icon",key:"icon"},{title:"Url",dataIndex:"url",key:"url"},{title:"方法",dataIndex:"method",key:"method",scopedSlots:{customRender:"method"}},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"},key:"status"},{title:"是否隐藏",dataIndex:"hidden",scopedSlots:{customRender:"hidden"},key:"hidden"},{title:"创建时间",dataIndex:"created_at",key:"created_at"},{title:"操作",key:"action",scopedSlots:{customRender:"action"},fixed:"right"}],data:[],tableLoading:!1,formModue:{title:"添加",visible:!1,formData:{},loadding:!1}}},methods:{getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e=Object.assign(e,this.pageParams,this.filters),this.tableLoading=!0,Object(o["getList"])(e).then((function(e){var a=e.data;t.data=a.list,t.tableLoading=!1,t.pagination.total=a.total})).catch((function(){t.tableLoading=!1}))},edit:function(t){t=JSON.parse(JSON.stringify(t)),this.$set(this,"formModue",{title:"编辑",visible:!0,formData:t})},del:function(t){var e=this;Object(o["del"])(t).then((function(t){e.$message.success(t.message),e.getList()}))},add:function(){this.$set(this,"formModue",{title:"添加",visible:!0,formData:{}})},success:function(){this.formModue.visible=!1,this.getList()}},mounted:function(){this.getList()}},d=l,u=a("5d22"),c=Object(u["a"])(d,n,r,!1,null,null,null);e["default"]=c.exports},d988:function(t,e,a){"use strict";a.r(e),a.d(e,"filterEmpty",(function(){return n})),a.d(e,"getStrFullLength",(function(){return r})),a.d(e,"cutStrByFullLength",(function(){return o})),a.d(e,"randomString",(function(){return i}));a("e3b5"),a("ea94"),a("a037"),a("5b12"),a("9b5f");function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter((function(t){return t.tag||t.text&&""!==t.text.trim()}))}var r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.split("").reduce((function(t,e){var a=e.charCodeAt(0);return a>=0&&a<=128?t+1:t+2}),0)},o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,a=0;return t.split("").reduce((function(t,n){var r=n.charCodeAt(0);return a+=r>=0&&r<=128?1:2,a<=e?t+n:t}),"")},i=function(t){t=t||32;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",a=e.length,n="",r=0;r<t;r++)n+=e.charAt(Math.floor(Math.random()*a));return n}}}]);