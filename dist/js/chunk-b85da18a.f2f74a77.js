(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b85da18a","chunk-7e142727","chunk-61e79f8a","chunk-2d0c798e","chunk-2d0e4e22","chunk-2d21f30b","chunk-2d0cf182"],{"07b6":function(t,e,a){},"1da1":function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));a("d3b7"),a("e6cf");function r(t,e,a,r,o,n,i){try{var s=t[n](i),l=s.value}catch(u){return void a(u)}s.done?e(l):Promise.resolve(l).then(r,o)}function o(t){return function(){var e=this,a=arguments;return new Promise((function(o,n){var i=t.apply(e,a);function s(t){r(i,o,n,s,l,"next",t)}function l(t){r(i,o,n,s,l,"throw",t)}s(void 0)}))}}},2339:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-header-wrapper",[a("a-card",{staticStyle:{"margin-top":"24px"},attrs:{bordered:!1}},[a("div",{staticClass:"operate"},[a("a-row",{staticClass:"filter",attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("a-col",{attrs:{span:12}},[t._v("列表")]),a("a-col",{attrs:{span:12}},[a("a-form",{staticClass:"form",attrs:{layout:"inline"}},[a("a-form-item",[a("a-input",{attrs:{placeholder:"search admin account","enter-button":""},model:{value:t.filter.account,callback:function(e){t.$set(t.filter,"account",e)},expression:"filter.account"}})],1),a("a-form-item",[a("a-button",{staticClass:"addAdmin",attrs:{type:"primary",loading:t.tableLoading,icon:"search"},on:{click:function(e){return t.getList()}}},[t._v(t._s(t.$t("search")))])],1)],1)],1)],1),a("a-button",{staticClass:"button",staticStyle:{width:"100%"},attrs:{type:"default"},on:{click:t.add}},[t._v(t._s(t.$t("add")))])],1),a("a-list",{attrs:{"item-layout":"horizontal","data-source":t.data},scopedSlots:t._u([{key:"renderItem",fn:function(e){return a("a-list-item",{},[a("a-row",{attrs:{type:"flex",justify:"space-between",align:"middle"}},[a("a-col",{attrs:{span:6}},[a("a-list-item-meta",{attrs:{description:"描述: "+e.description}},[a("a",{attrs:{slot:"title",href:"javascript:;"},slot:"title"},[t._v(t._s(e.account)+" "),a("br"),t._v(" "),a("span",[t._v(t._s(e.email))])]),a("a-avatar",{attrs:{slot:"avatar",shape:"square",src:e.avatar,size:64},slot:"avatar"})],1)],1),a("a-col",{staticStyle:{},attrs:{span:6}},[a("div",{staticClass:"updated_at"},[t._v(" 更新时间 "),a("div",[t._v(t._s(e.updated_at))])])]),a("a-col",{staticStyle:{},attrs:{span:6}},[a("div",{staticClass:"updated_at"},t._l(e.roles,(function(e){return a("a-tag",{key:e,attrs:{color:"green"}},[t._v(t._s(e))])})),1)]),a("a-col",{attrs:{span:3}},["admin"!=e.account?a("div",{staticClass:"operation"},[a("a-button",{attrs:{type:"link"},on:{click:function(a){return t.edit(e)}}},[t._v(t._s(t.$t("edit")))]),a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},[t._v("更多"),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a-popconfirm",{attrs:{title:t.$t("confirm_delete"),"ok-text":"Yes","cancel-text":"No"},on:{confirm:function(a){return t.del(e.id)}}},[a("a",{attrs:{href:"#"}},[t._v(t._s(t.$t("delete")))])])],1)],1)],1)],1):t._e()])],1)],1)}}])})],1),a("a-drawer",{attrs:{title:t.formModue.title,width:"40%",visible:t.formModue.visible,footer:null},on:{close:function(e){t.formModue.visible=!1}}},[t.formModue.visible?a("module-form",{ref:"moduleForm",attrs:{formData:t.formModue.formData},on:{"update:formData":function(e){return t.$set(t.formModue,"formData",e)},"update:form-data":function(e){return t.$set(t.formModue,"formData",e)},success:t.success}}):t._e()],1)],1)},o=[],n=(a("4de4"),a("d3b7"),a("50fc")),i=a("423f"),s={name:"AdminList",components:{ModuleForm:i["default"]},data:function(){var t=this;return{data:[],status:"all",page:1,pagination:{onChange:function(e){t.page=e,t.getList()},showSizeChanger:!0,showQuickJumper:!0,pageSize:20,total:50},formModue:{title:"添加",visible:!1,formData:{}},filter:{account:""},confirmLoading:!1,tableLoading:!1}},created:function(){this.getList()},methods:{getList:function(){var t=this,e={page:this.page,pageSize:this.pageSize};e=Object.assign(e,this.filter),this.tableLoading=!0,Object(n["getList"])(e).then((function(e){var a=e.data;t.data=a.list})).finally((function(){t.tableLoading=!1}))},add:function(){this.formModue.visible=!0,this.formModue.formData={}},del:function(t){var e=this;Object(n["del"])(t).then((function(t){e.$message.success(t.message),e.getList()}))},success:function(){this.formModue.visible=!1,this.getList()},edit:function(t){t=JSON.parse(JSON.stringify(t)),this.$set(this,"formModue",{title:"编辑",visible:!0,formData:t})},show:function(){this.formModue={title:"编辑",visible:!0}}}},l=s,u=(a("c1a5"),a("2877")),d=Object(u["a"])(l,r,o,!1,null,"1797c29a",null);e["default"]=d.exports},"423f":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-form-model",{ref:"ruleForm",attrs:{rules:t.rules,model:t.modelForm,"label-col":{span:6},"wrapper-col":{span:16}}},[a("a-form-model-item",{attrs:{label:"Account",prop:"account"}},[a("a-input",{model:{value:t.modelForm.account,callback:function(e){t.$set(t.modelForm,"account",e)},expression:"modelForm.account"}})],1),a("a-form-model-item",{attrs:{label:"Avatar",prop:"avatar"}},[a("upload-image",{attrs:{imgUrl:t.modelForm.avatar},on:{"update:imgUrl":function(e){return t.$set(t.modelForm,"avatar",e)},"update:img-url":function(e){return t.$set(t.modelForm,"avatar",e)}}})],1),a("a-form-model-item",{attrs:{label:"用户角色",prop:"permission_ids"}},[a("a-tree-select",{staticStyle:{width:"100%"},attrs:{"dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":t.tree,"tree-checkable":"",replaceFields:t.replaceFields,placeholder:"Please select"},model:{value:t.modelForm.role_ids,callback:function(e){t.$set(t.modelForm,"role_ids",e)},expression:"modelForm.role_ids"}})],1),a("a-form-model-item",{attrs:{label:"Email",prop:"email"}},[a("a-input",{model:{value:t.modelForm.email,callback:function(e){t.$set(t.modelForm,"email",e)},expression:"modelForm.email"}})],1),a("a-form-model-item",{attrs:{label:"Phone",prop:"phone"}},[a("a-input",{attrs:{autocomplete:"phone"},model:{value:t.modelForm.phone,callback:function(e){t.$set(t.modelForm,"phone",e)},expression:"modelForm.phone"}})],1),a("a-form-model-item",{attrs:{label:"Password",prop:"password"}},[a("a-input",{attrs:{type:"text",autocomplete:"password"},model:{value:t.modelForm.password,callback:function(e){t.$set(t.modelForm,"password",e)},expression:"modelForm.password"}})],1),a("a-form-model-item",{attrs:{label:"Confirm Password",prop:"confirm_password"}},[a("a-input",{attrs:{type:"text"},model:{value:t.modelForm.confirm_password,callback:function(e){t.$set(t.modelForm,"confirm_password",e)},expression:"modelForm.confirm_password"}})],1),a("a-form-model-item",{attrs:{label:"Desccription",prop:"description"}},[a("a-input",{attrs:{type:"textarea"},model:{value:t.modelForm.description,callback:function(e){t.$set(t.modelForm,"description",e)},expression:"modelForm.description"}})],1),a("a-form-model-item",{attrs:{"wrapper-col":{span:16,offset:6}}},[a("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.onSubmit}},[t._v("确认")])],1)],1)},o=[],n=(a("96cf"),a("1da1")),i=a("61f7"),s=a("4588"),l=a("50fc"),u={name:"ModuleForm",components:{UploadImage:s["default"]},props:{formData:{type:Object,default:function(){return{}}}},data:function(){var t=this,e=function(e,a,r){var o=t.modelForm.password;return o?0==o.length?r():o!==a?r(new Error("两次输入密码不一致")):r():r()};return{modelForm:{},rules:{account:[{required:!0,message:"请输入账号",trigger:"blur"}],avatar:[{required:!1,message:"Please upload avatar",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱"}],phone:[{required:!0,message:"请输入电话号码",trigger:"blur"},{validator:i["validatePhone"],trigger:"blur"}],password:[{validator:i["validatePassword"],trigger:"blur"}],confirm_password:[{validator:i["validatePassword"],trigger:"blur"},{validator:e,trigger:"blur"}],description:[{required:!0,message:"请输入管理员的描述",trigger:"blur"}]},loading:!1,tree:[],replaceFields:{children:"children",title:"name",key:"id",value:"id"}}},methods:{onSubmit:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(!e)return!1;var a;t.loading=!0,a=t.modelForm.id?Object(l["update"])(t.modelForm.id,t.modelForm):Object(l["add"])(t.modelForm),a.then((function(e){t.$message.success(e.message),t.$emit("success")})).catch((function(){t.loading=!1}))}))},getRoleTree:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(l["getRoleTree"])().then((function(e){var a=e.data;t.tree=a}));case 2:case"end":return e.stop()}}),e)})))()}},created:function(){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getRoleTree();case 2:t.modelForm=t.formData;case 3:case"end":return e.stop()}}),e)})))()}},d=u,c=a("2877"),m=Object(c["a"])(d,r,o,!1,null,null,null);e["default"]=m.exports},4588:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-upload",{staticClass:"image-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,action:t.url,data:t.data,"before-upload":t.beforeUpload},on:{change:t.handleChange}},[t.image?a("img",{attrs:{src:t.image,alt:"image"}}):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v("Upload")])],1)])],1)},o=[],n=a("91b6"),i=a("d988"),s={name:"UploadImage",props:{imgUrl:{type:String,default:function(){return""}}},data:function(){return{image:"https://cdn.surest.cn/uploads/t4zDf6BwrMWhA8sjzeEaWxhYCwsCpt4P",loading:!1,url:"",upload_dir:"",host:"",data:{token:"",key:""}}},created:function(){this.setUploadInfo(),this.image=this.imgUrl},methods:{setUploadInfo:function(){var t=this;Object(n["getQiniuInfo"])().then((function(e){var a=e.data,r=(a.bucket,a.token),o=a.url,n=a.host,s=a.upload_dir;t.url=o,t.data.token=r,t.host=n,t.upload_dir=s,t.data.key=t.upload_dir+Object(i["randomString"])()}))},handleChange:function(t){if(this.data.key=this.upload_dir+Object(i["randomString"])(),"uploading"!==t.file.status){if("done"===t.file.status){this.loading=!1;var e=this.host+t.file.response.key;this.uploadedImage(e)}}else this.loading=!0},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;e||this.$message.error("You can only upload JPG file!");var a=t.size/1024/1024<2;return a||this.$message.error("Image must smaller than 2MB!"),e&&a},uploadedImage:function(t){this.image=t,this.$emit("update:imgUrl",t)}}},l=s,u=(a("4ea9"),a("2877")),d=Object(u["a"])(l,r,o,!1,null,"1ccf5a9c",null);e["default"]=d.exports},"4ea9":function(t,e,a){"use strict";var r=a("9817"),o=a.n(r);o.a},"50fc":function(t,e,a){"use strict";a.r(e),a.d(e,"getList",(function(){return o})),a.d(e,"add",(function(){return n})),a.d(e,"update",(function(){return i})),a.d(e,"del",(function(){return s})),a.d(e,"getRoleTree",(function(){return l}));var r=a("b775");function o(t){return Object(r["default"])({url:"/admin",method:"get",params:t})}function n(t){return Object(r["default"])({url:"/admin/store",method:"post",data:t})}function i(t,e){return Object(r["default"])({url:"/admin/save",method:"put",data:e})}function s(t){return Object(r["default"])({url:"/admin/delete",method:"delete",data:{id:t}})}function l(){return Object(r["default"])({url:"/admin/tree",method:"get"})}},"61f7":function(t,e,a){"use strict";function r(t,e,a){return e?/^1[3456789]\d{9}$/.test(e)?a():a(new Error("手机号码不符合规范")):a(new Error("Please input the Phone"))}function o(t,e,a){return e&&(e.length>12||e.length<6)?a(new Error("密码限定6-12个字符串")):a()}function n(t,e,a){var r=this.modelForm.password;return r!==e?a(new Error("两次输入密码不一致")):a()}a.r(e),a.d(e,"validatePhone",(function(){return r})),a.d(e,"validatePassword",(function(){return o})),a.d(e,"validateConfirmPassword",(function(){return n}))},"91b6":function(t,e,a){"use strict";a.r(e),a.d(e,"getQiniuInfo",(function(){return o}));var r=a("b775");function o(t){return Object(r["default"])({url:"/qiniu",method:"get",data:t})}},9817:function(t,e,a){},c1a5:function(t,e,a){"use strict";var r=a("07b6"),o=a.n(r);o.a},d988:function(t,e,a){"use strict";a.r(e),a.d(e,"filterEmpty",(function(){return r})),a.d(e,"getStrFullLength",(function(){return o})),a.d(e,"cutStrByFullLength",(function(){return n})),a.d(e,"randomString",(function(){return i}));a("4de4"),a("13d5"),a("ac1f"),a("1276"),a("498a");function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.filter((function(t){return t.tag||t.text&&""!==t.text.trim()}))}var o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.split("").reduce((function(t,e){var a=e.charCodeAt(0);return a>=0&&a<=128?t+1:t+2}),0)},n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0,a=0;return t.split("").reduce((function(t,r){var o=r.charCodeAt(0);return a+=o>=0&&o<=128?1:2,a<=e?t+r:t}),"")},i=function(t){t=t||32;for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",a=e.length,r="",o=0;o<t;o++)r+=e.charAt(Math.floor(Math.random()*a));return r}}}]);